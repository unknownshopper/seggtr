<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Zonas recomendadas para inversi√≥n</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./style.css">
  <link rel="stylesheet" href="./inversion.css">
</head>
<body class="inv">
  <div class="shell">
    <header class="header">
      <img class="logo" src="logcho.png" alt="The Unknown Shopper" onerror="this.onerror=null; this.src='logch.png'" />
      <div>
        <h1>Zonas recomendadas para inversi√≥n</h1>
        <p class="lead">Ranking basado en intenci√≥n, awareness, favorabilidad y tama√±o de muestra</p>
      </div>
      <div class="kpi" id="kpis"></div>
    </header>

    <div class="cards">
      <section class="card print-center">
        <div class="toolbar">
          <span class="pill" id="dataSource">Cargando datos‚Ä¶</span>
          <span class="pill" id="totalResp"></span>
          <span class="pill" id="zonesCount"></span>
          <span class="pill" id="lastUpdated"></span>
          <button class="btn outline no-print" style="margin-left:auto" onclick="window.print()">üñ®Ô∏è Descargar PDF</button>
        </div>
      </section>

      <section class="card grid-6 print-center">
        <h2>Top 5 zonas recomendadas</h2>
        <canvas id="chartTop"></canvas>
        <p class="note" style="margin-top:10px">
          El ranking considera cuatro factores ponderados: 50% intenci√≥n promedio (0‚Äì10), 20% awareness (conocimiento de marca), 20% favorabilidad (5‚Äì7 como favorable) y 10% tama√±o de muestra. Se aplica una penalizaci√≥n del 20% a zonas con n < 20 para evitar sesgos por muestras peque√±as. Adicionalmente, usamos el <strong>tama√±o de muestra (n)</strong> como un <em>proxy</em> de <strong>flujo de personas/exposici√≥n</strong> en la zona.
        </p>
      </section>

      <section class="card grid-6 print-center">
        <h2>Recomendaci√≥n r√°pida</h2>
        <ol id="quickList" class="muted"></ol>
      </section>

      <section class="card grid-12 print-center">
        <h2>Recomendaci√≥n ejecutiva: ubicaci√≥n sugerida</h2>
        <div id="execReco" class="note"></div>
      </section>

      <section class="card grid-12 print-center">
        <h2>ROI y rentabilidad detallada</h2>
        <p class="note" style="margin:6px 0 12px 0">
          <strong>¬øQu√© es el ROI?</strong> El Retorno Sobre la Inversi√≥n compara los beneficios generados con la inversi√≥n necesaria.
          <strong>¬øPor qu√© importa?</strong> Permite evaluar viabilidad, estimar en cu√°nto tiempo se recupera la inversi√≥n (payback), priorizar zonas/canales y ajustar precios y pauta.
          <strong>C√≥mo leerlo:</strong> ROI anual &gt; 0% indica rentabilidad; un payback menor implica recuperaci√≥n m√°s r√°pida; el punto de equilibrio muestra cu√°ntas unidades/mes cubren los costos fijos.
          <strong>Nota:</strong> Estos c√°lculos dependen de supuestos (precio, costos, volumen, inversi√≥n) que puedes editar a continuaci√≥n.
        </p>
        <div class="grid-6">
          <div class="note"><strong>Par√°metros (editar):</strong></div>
          <ul id="roi-params" class="muted">
            <li>
              Precio promedio de venta:
              <input id="inp-precio" type="number" min="0" step="0.01" placeholder="35000" class="roi-input" />
            </li>
            <li>
              Costo del producto (COGS):
              <input id="inp-cogs" type="number" min="0" step="0.01" placeholder="26000" class="roi-input" />
            </li>
            <li>
              Gasto de adquisici√≥n por venta (marketing/ventas):
              <input id="inp-cac" type="number" min="0" step="0.01" placeholder="1500" class="roi-input" />
            </li>
            <li>
              Volumen mensual estimado (unidades):
              <input id="inp-volumen" type="number" min="0" step="1" placeholder="10" class="roi-input" />
            </li>
            <li>
              Costos fijos mensuales:
              <input id="inp-fijos" type="number" min="0" step="0.01" placeholder="30000" class="roi-input" />
            </li>
            <li>
              Inversi√≥n inicial (adecuaciones, inventario, apertura):
              <input id="inp-inversion" type="number" min="0" step="0.01" placeholder="300000" class="roi-input" />
            </li>
          </ul>
        </div>
        <div class="grid-6">
          <div class="note"><strong>Resultados (autom√°tico):</strong></div>
          <ul id="roi-results">
            <li>Margen bruto por unidad: <span id="roi-margen-unit">‚Äî</span></li>
            <li>Margen de contribuci√≥n mensual: <span id="roi-contrib-mes">‚Äî</span></li>
            <li>Punto de equilibrio (unidades/mes): <span id="roi-bep-units">‚Äî</span></li>
            <li>Payback estimado: <span id="roi-payback">‚Äî</span></li>
            <li>ROI anual estimado: <span id="roi-annual">‚Äî</span></li>
          </ul>
        </div>
        <div class="grid-12" style="margin-top:12px">
          <div class="note">Notas: Edite los par√°metros para ver el impacto. Los c√°lculos se guardan en este dispositivo y pueden integrarse con <code>data-manager.js</code> o Firestore.</div>
        </div>
      </section>

      <section class="card">
        <h2>Tabla de ranking por zona</h2>
        <div class="legend muted"> 
          <span>Score = 0.5√óIntenci√≥n + 0.2√óAwareness + 0.2√óFavorabilidad + 0.1√óTama√±o muestra</span>
          <span>Penalizaci√≥n si n &lt; 20</span>
        </div>
        <table>
          <thead>
            <tr>
              <th>Rank</th>
              <th>Zona</th>
              <th>Score</th>
              <th>Intenci√≥n</th>
              <th>n</th>
              <th>Awareness</th>
              <th>Favorable</th>
              <th>% usa moto</th>
            </tr>
          </thead>
          <tbody id="rows"></tbody>
        </table>
      </section>
    </div>
    <div class="foot">
      <a href="index.html" class="btn outline">‚Üê Volver al inicio</a>
      <span class="note">Proyecto ‚Ä¢ The Unknown Shoppers</span>
    </div>
    <!-- Footer para impresi√≥n en todas las p√°ginas -->
    <div class="print-footer">The Unknown Shoppers</div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script src="./firebase-config.js"></script>
  <script src="./auth.js"></script>
  <script src="./data-manager.js"></script>
  <script src="./inversion.js"></script>
</body>
</html>